<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.mapper.CampusPaymentMapper">

	<delete id="cart_delete">
		delete from campus_cart where u_userid = #{u_userid} and c_cartnumber = #{c_cartnumber}
	</delete>

	<delete id="payment_delete">
		delete from campus_order_detail where o_number = #{o_number}
	</delete>
	
	<delete id="payment_delete2">
		delete from campus_order where o_number = #{o_number}
	</delete>
	
	<update id="stock_change">
		update campus_product set p_stock = (p_stock-#{p_stock}) where p_number = #{p_number}
	</update>
	
	<update id="stock_change_plus">
		update campus_product set p_stock = (p_stock+#{p_stock}) where p_number = #{p_number}
	</update>
	
	
	<select id="cancel_number" resultType="com.spring.domain.CampusOrderVO">
		select o_number from campus_order where success_code = #{success_code}
	</select>
	
	<delete id="pay_cancel">
		delete from campus_order where o_number = #{o_number}
	</delete>
	
	<delete id="pay_cancel_detail">
		delete from campus_order_detail where o_number = #{o_number}
	</delete>

	<insert id="payment_add">
		insert into campus_order(o_number, u_userid, o_address1, o_address2, o_address3, o_address4, o_name, o_phone, o_sysdate, o_ordercode, total_pay, total_count, success_code) 
		values(CAMPUS_ORDER_SEQUENCE.nextval, #{u_userid}, #{o_address1}, #{o_address2}, #{o_address3}, #{o_address4}, #{o_name}, #{o_phone}, sysdate, #{o_ordercode}, #{total_pay}, #{total_count}, #{success_code})
	</insert>
	
	<select id="o_number" resultType="com.spring.domain.CampusOrderVO">
		select o_number from campus_order where o_ordercode = #{o_ordercode}
	</select>

	<insert id="payment_detail_add">
		insert into campus_order_detail(d_number, p_number, o_number, d_count, d_price, d_option)
		values(CAMPUS_DETAIL_SEQUENCE.nextval,#{p_number}, #{o_number}, #{d_count}, #{d_price}, #{d_option})
	</insert>
	
	<select id="listpaymentselect" resultType="com.spring.domain.CampusOrderVO">
		select * from campus_order where u_userid = #{u_userid}
	</select>
	
	<select id="listpaymentselectdetail" resultType="com.spring.domain.CampusOrderDetailVO">
		select * from campus_order_detail where o_number = #{o_number}
	</select>
	
	<select id="orderdetaillist" resultType="com.spring.domain.CampusOrderDetailVO">
		select o.u_userid, d.p_number from campus_order o, campus_order_detail d
		where o.o_number = d.o_number and o.u_userid = #{u_userid}
	</select>
	
	<!-- 캠핑 -->
	
	<insert id="payment_camping_add">
		insert into campus_camping (c_number, c_name, c_area, c_sysdate, c_rsysdate, c_content, c_pay, c_phone, u_userid, c_nname)
		values(CAMPUS_CAMPING_SEQUENCE.nextval, #{c_name}, #{c_area}, sysdate, #{c_rsysdate}, #{c_content}, #{c_pay}, #{c_phone}, #{u_userid}, #{c_nname})
	</insert>
	
	<select id="payment_camping_view" resultType="com.spring.domain.CampusCampingjangVO">
		select * from campus_camping where u_userid = #{u_userid}
	</select>
	
	<delete id="payment_camping_delete">
		delete from campus_camping where c_content = #{success_code}
	</delete>
	
	<select id="payment_camping_view_one" resultType="com.spring.domain.CampusCampingjangVO">
		select * from campus_camping where c_rsysdate = #{c_rsysdate} and c_area = #{c_area}
	</select>
	
</mapper>